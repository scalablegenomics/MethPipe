{
    "$type": "Form",
    "fields": [
        {
            "$type": "TextBox",
            "size": 400,
            "minLength": 0,
            "maxLength": 150,
            "value": "Example [LocalDateTime]",
            "label": "Analysis Name",
            "required": true,
            "requiredMessage": "Please enter name for your app session.",
            "id": "app-session-name"
        },

        {
            "$type": "FileChooser",
			"id": "fastq-file-T-rich",
			"label": "Input read file",
			"size": 400,
			"valueType": "Input",
			"allowedPermissions": "read",
			"extensionFilters": ".fq, .fastq",
			"chooserType": "ByProject",
			"multiselect": false,
            "required": true,
			"requiredMessage": "Please choose a file",
		},

        {
            "$type": "FileChooser",
			"id": "fastq-file-A-rich",
			"label": "Input read file (second mate; if single-end, leave blank)",
			"value": "NA",
			"size": 400,
			"valueType": "Input",
			"allowedPermissions": "read",
			"extensionFilters": ".fq, .fastq",
			"chooserType": "ByProject",
			"multiselect": false,
            "required": false,
		},

        {
        	"$type": "FileChooser",
			"id": "genome-file",
			"label": "Reference genome sequence file",
			"size": 400,
			"valueType": "Input",
			"allowedPermissions": "read",
			"extensionFilters": ".fa",
			"chooserType": "ByProject",
			"multiselect": true,
            "required": true,
			"requiredMessage": "Please choose reference genome sequence file",
		},


{"$type": "SectionBreak" },

        {
            "$type": "ProjectChooser",
            "size": 400,
            "valueType": "Output",
            "allowedPermissions": "owner",
            "label": "Save Results To",
            "required": true,
            "requiredMessage": "Please choose a project",
            "id": "project-id",
            "allowResourceCreation": true,
            "rules": "is-project-owner"
        },

{ "$type": "SectionBreak" },


    {
    "$type": "FieldSet",
		"id": "mapping",
		"label": "Options for mapping reads",
		"isCollapsible": true,
		"isOpen": false,
		"fields": [
                {
					"$type": "Numeric",
					"id": "max-mismatch",
					"size": 50, 
					"required": false,
					"label": "Max mismatches allowed in reads (can be fractional)",
					"min": 0, 
					"max": 100,
					"value": 6,
					"numericType": "Integer", 
					}, 
			{
				"$type": "Numeric",
				"id": "max-mapping-locs",
				"size": 50, 
				"required": false,
				"label": "maximum allowed mappings for a read",
				"min": 1, 
				"max": 100,
				"value": 1,
				"numericType": "Integer", 
				}, 
        {
            "$type": "TextBox",
			        "size": 300,
			        "value": "",
			        "label": "Adapter sequences",
			        "required": false,
			        "requiredMessage": "Please enter name for your app session.",
			        "id": "adapter-seq",
        }        
        ]
    },
        {
            "$type": "SectionBreak"
        },

{
"$type": "FieldSet",
"id": "mapping",
"label": "Options for estimating methylation level, coverage and conversion rate",
"isCollapsible": true,
"isOpen": false,
"fields": [
		{
			"$type": "Numeric",
			"id": "max-read-length",
			"size": 50, 
			"required": false,
			"label": "max read length in input file",
			"min": 20, 
			"max": 10000,
			"value": 10000,
			"numericType": "Integer", 
		}, 
    	{
			"$type": "RadioButton",
			"id": "non-CpG",
			"label": "Process non-CpG sites:",
			"choices": [{"value": 1}],
			"togglers": [
				{
					"toggleOnValue": 1, 
					"toggleFields": "non-CpG" 
				}    
			]
		},
]
},

{ "$type": "SectionBreak" },

{
    "$type": "FieldSet",
    "id": "hmr-op",
	"label": "Options for identifying hypo-methylated regions",
	"isCollapsible": true,
	"isOpen": false,
	"fields": [
		{
			"$type": "Numeric",
			"id": "num-iter",
			"size": 50, 
			"required": false,
			"label": "Number of iterations when training model",
			"min": 0, 
			"max": 100,
			"value": 15,
			"numericType": "Integer", 
			}, 
		{
			"$type": "Numeric",
			"id": "desert-size",
			"size": 50, 
			"required": false,
			"label": "Max distance between CpGs with reads in HMR",
			"min": 5000, 
			"max": 20000,
			"value": 10000,
			"numericType": "Integer", 
			}, 
		{
			"$type": "RadioButton",
			"id": "do-pmd",
			"label": "Identify PMRs instead of HMRs:",
			"required": false,
			"choices": [{ "value": 1 }],
			"togglers": [
				{
					"toggleOnValue": 1, 
					"toggleFields": "do-pmd" 
				}    
			]
		},


                ]
 },

 {    
	 "$type": "SectionBreak"
 },


{
    "$type": "FieldSet",
    "id": "amr-op",
	"label": "Options for identifying allelic methylated regions",
	"isCollapsible": true,
	"isOpen": false,
	"fields": [

		{
			"$type": "RadioButton",
			"id": "amr-enable",
			"label": "Call AMR identification program (disabled by default)",
			"required": false,
			"choices": [{ "value": 1}],
			"togglers": [
				{
					"toggleOnValue": 1, 
					"toggleFields": "amr-enable" 
				}    
			]
	    },

		{
			"$type": "Numeric",
			"id": "amr-num-iter",
			"size": 50, 
			"required": false,
			"label": "Number of iterations for EM during AMR identification",
			"min": 10, 
			"max": 100,
			"value": 15,
			"numericType": "Integer", 
	     }, 

		{
			"$type": "Numeric",
			"id": "amr-sliding-win-size",
			"size": 50, 
			"required": false,
			"label": "Sliding window size",
			"min": 100, 
			"max": 1000,
			"value": 200,
			"numericType": "Integer", 
	     }, 

		{
			"$type": "Numeric",
			"id": "amr-min-coverage",
			"size": 50, 
			"required": false,
			"label": "Min coverage per CpG",
			"min": 5, 
			"max": 1000,
			"value": 5,
			"numericType": "FloatingPoint", 
	     }, 

		{
			"$type": "Numeric",
			"id": "amr-allowed-gap",
			"size": 50, 
			"required": false,
			"label": "Min allowed gaps between AMRs when merging (in bp)",
			"min": 0, 
			"max": 500,
			"value": 200,
			"numericType": "Integer", 
	     }, 

		{
			"$type": "Numeric",
			"id": "amr-pval-cutoff",
			"size": 50, 
			"required": false,
			"label": "P-value cutoff",
			"min": 0, 
			"max": 0.1,
			"value": 0.01,
			"numericType": "FloatingPoint", 
	     }, 

		{
			"$type": "RadioButton",
			"id": "amr-BH-adjust",
			"label": "Use Benjaminin-Hochberg adjustment",
			"required": false,
			"choices": [{ "value": 1}],
			"togglers": [
				{
					"toggleOnValue": 1, 
					"toggleFields": "amr-BH-adjustment" 
				}    
			]
	    },

		{
			"$type": "RadioButton",
			"id": "amr-use-BIC",
			"label": "Use BIC to compare models",
			"required": false,
			"choices": [{ "value": 1}],
			"togglers": [
				{
					"toggleOnValue": 1, 
					"toggleFields": "amr-use-BIC" 
				}    
			]
	    },

                ]
},


    ],
    "rulesets":[
        {
            "$type": "PermissionValidationRule",
            "permissions": "Read",
            "severity": "Error",
            "message": "You do not have read access to the selected sample",
            "id": "sample-reader"
        },
        {
            "$type": "PermissionValidationRule",
            "permissions": "Own",
            "severity": "Error",
            "message": "You aren't the owner of the selected project.",
            "id": "is-project-owner"
        }
    ]
}
